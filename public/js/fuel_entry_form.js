// Generated by CoffeeScript 2.4.1
(function() {
  this.FuelEntryForm = class FuelEntryForm {
    constructor() {
      var $previousOdometer;
      this._handleOdometerInput = this._handleOdometerInput.bind(this);
      this._handleUnitPrice = this._handleUnitPrice.bind(this);
      this.odometerInput = $('#fuel-entry-odometer');
      if (!this.odometerInput.length) {
        return;
      }
      $previousOdometer = $('#previous-fuel-entry-odometer');
      if ($previousOdometer.length) {
        this.previousOdometer = $previousOdometer.data('value');
        this.tripWrapper = $('#fuel-entry-trip');
        this.tripSpan = this.tripWrapper.find('span');
        this.odometerInput.on('input', this._handleOdometerInput);
      }
      this.litersInput = $('#fuel-entry-liters');
      this.totalPriceInput = $('#fuel-entry-total_price');
      this.unitPriceWrapper = $('#fuel-entry-unit-price');
      this.unitPriceSpan = this.unitPriceWrapper.find('span');
      this.litersInput.add(this.totalPriceInput).on('input', this._handleUnitPrice);
    }

    _handleOdometerInput() {
      var odometer, trip;
      odometer = this.odometerInput.val();
      trip = odometer - this.previousOdometer;
      if (trip < 0) {
        return this.tripWrapper.addClass('d-none');
      } else {
        this.tripSpan.text(trip);
        return this.tripWrapper.removeClass('d-none');
      }
    }

    _handleUnitPrice() {
      var liters, parts, totalPrice, unitPrice;
      liters = this.litersInput.val();
      totalPrice = this.totalPriceInput.val();
      if (!(liters && totalPrice)) {
        return;
      }
      liters = Number(liters);
      totalPrice = Number(totalPrice);
      if (liters === 0) {
        return;
      }
      unitPrice = totalPrice / liters;
      parts = unitPrice.toFixed(2).split('.');
      parts[0] = parts[0].replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1 ');
      unitPrice = parts.join(',');
      this.unitPriceSpan.text(unitPrice);
      return this.unitPriceWrapper.removeClass('d-none');
    }

  };

}).call(this);
